\documentclass[final]{article}
\usepackage[cp1251]{inputenc}
\usepackage[russian]{babel}
\usepackage{graphicx}
\usepackage[colorlinks=true,backref,hidelinks,final]{hyperref}
\usepackage{indentfirst}
\usepackage{enumerate}
\usepackage{keystroke}
\usepackage[lflt]{floatflt}
\usepackage{tabularx}
\usepackage{xkeyval}
\hypersetup{pdfauthor=Фролов Павел,
pdftitle="Программа подготовки таблиц для проведения тарировки" Руководство пользователя,
pdfdisplaydoctitle=True}

\begin{document}
%\centering
%\includegraphics[width=50px]{icon.png}
\title{<<Программа подготовки таблиц для проведения тарировки>>\\Руководство пользователя}
\author{Фролов Павел}
\date{\today}
\maketitle
\newpage
\tableofcontents
\newpage
\section{Общие сведения}
\label{sec:general}
\subsection{Цели и задачи}
\label{sec:targ}
Данная программа служит для автоматизации подготовки бланков результатов проведения тарировки датчиков уровня топлива <<Системы автоматической измерения уровня топливa>> (далее АСИУТ).

Основной целью при написании программы было сокращениевремени на подготовку бланков и сокращение до минимум ошибок, возникающих при записи серийных номеров датчиков.
\subsection{Используемые технологии и системные требования}
\label{sec:descr}
Программа написана с испольцованием технологий COM и OLE для обеспечения совместимости с разнуми версиями Microsoft\textregistered{} Office\textregistered{}. Для данной версии программы требуется Microsoft Excel версии не ниже 2003 (v.12). Возможно программа будет работат и с более старыми версиями Microsoft Excel, но тестирование на них не проводилось.

Программа совместима со всеми версиями Microsoft\textregistered{} Windows\textregistered{}, в которых работают указанные офисные пакеты. Для работы предпочтительно использовать Windows\textregistered{} XP с установленным SP2 или более новую операционную систему.
\newpage
\section{Установка программы}
\subsection{Описание установщика}
Для удобства пользователя программа поставляется в виде установочного пакета\footnote{Для создания пакета использовалась система InstallAware\textregistered{} 9. Для её работы требуется Microsoft\textregistered{} Installer\textregistered{}, который обычно уже присуствует в системе Windows\textregistered{} 2000 и выше.}. Программа установки копирует файлы программы в указанный каталог, создает ярлыки для удобного запуска программы и регистрирует в системе программу для корретного удаления.

Для установки программы требуется около 0,5 Мб свободного места на диске. Программа не вносит никаких изменений в реестр системы и может распространяться простым копированием с сохранением минимального набора файлов (\autoref{sec:minfile}), необходимых для работы программы.
\subsection{Состав программы}
\label{sec:progfiles}
В состав программы входят следующие файлы:
\begin{enumerate}[\quad]
\item \textbf{tarprog.exe} "--- основной исполняемый файл программы;
\item \textbf{tarprog.ini} "--- файл настроек программы (\autoref{sec:iniformat});
\item \textbf{tpl.xls} "--- шаблон бланка (\autoref{sec:tpl}).
\end{enumerate}
\subsection{Минимальный набор файлов}
\label{sec:minfile}
Для работы программы требуется следующий минимальный набор файлов:
\begin{enumerate}
\item tarprog.exe
\item tpl.xls
\end{enumerate}

Файл настроек программы будет создан после окончания первого сеанса работы с ней. Формат файла настроек описан в разделе \ref{sec:iniformat}.
\newpage
\section{Вспомогательные файлы программы}
\label{sec:addfile}
\subsection{tpl.xls}
\label{sec:tpl}
Этот файл представляет собой книгу Microsoft\textregistered{} Excel\textregistered{} XP-2003. В нем содержится шаблон бланка таблицы тарировки.

Пользователь по своему усмотрению может изменять оформление шаблона, но для сохранения работоспособности программы не следует изменять положение ячеек, в которых содержатся номера датчиков, комплектов и пр.

Если возникнет необходимость, то в будущих версиях шаблон может быть переработан, и будет добавлена возможность полного изменения шаблона.

\subsection{tarprog.ini}
\label{sec:inifile}
В этом файле хранятся настройки программы. Файл имеет простой текстовый фармат. В нем сохраняются значения серийных номеров датчиков, номеров блоков, номер и марка тепловоза, для которого готовится комплект блоков.

Формат файла настроек будет описан в следующем разделе.
\newpage
\section{Формат файла настроек программы}
\label{sec:iniformat}
После первого запуска программы файл примет следующий вид:
\begin{quote}
\begin{verbatim}
[Settings]
  steamtrain=2ТЭ116
  stnum=140
  comp1=218
  comp2=219
  pr11=654546519523
  pr12=654546519524
  pr21=654546519525
  pr22=654546519526
  temp1=5489500
  temp2=5489501
\end{verbatim}
\end{quote}

Рассмотрим назначение всех переменных:\vspace{6pt}

\begin{tabularx}{0.95\textwidth}{r|X}
\rule{0px}{3ex}\textbf{Переменная} & \textbf{Назначение}\\
\hline
\textbf{steamtrain} & марка тепловоза, для которого подготавливается комплект АСИУТ\\
\textbf{stnum} & серийный номер тепловоза\\
\textbf{comp1} & серийный номер первого блока из комплекта\\
\textbf{comp2} & серийный номер второго блока из комплекта\\
\textbf{pr11} & серийный номер первого датчика уровня первого блока из комплекта\\
\textbf{pr12} & серийный номер второго датчика уровня первого блока из комплекта\\
\textbf{pr21} & серийный номер первого датчика уровня второго блока из комплекта\\
\textbf{pr22} & серийный номер второго датчика уровня второго блока из комплекта\\
\textbf{temp1} & серийный номер датчика температуры первого блока из комплекта\\
\textbf{temp2} & серийный номер датчика температуры второго блока из комплекта\\
\end{tabularx}
\newpage
\section{Работа с программой}
\label{sec:interf}
\subsection{Интерфейс программы}
\subsubsection{Окно программы}
\begin{figure}[h]
\centering
\includegraphics[width=0.8\textwidth]{interface.png}
\caption{Окно программы.}
\label{fig:wind}
\end{figure}
На рисунке \ref{fig:wind} представлен общий вид окна программы с примером заполнения полей. Для правильной работы программы должны быть правильно заполнены все поля.
\newpage
\subsubsection{Описание элементов интерфейса программы}
Окно программы разделено на два блока:
\begin{itemize}
    \item Общие сведения
    \item Датчики
\end{itemize}

В блоке <<Общие сведения>> указываются основные сведения для конкретного комплекта АСИУТ.

В поле <<Тарировка для:>> занисится серийный марка тепловоза.

В поле <<№>> заносится серийный номер тепловоза, для которого предназначен комплект АСИУТ.

В поля <<Комплекты>> заносятся серийные номера комплектов АСИУТ. Для одного тепловоза требуется два комплекта измерителей. Для удобства пользователя при вводе номера первого комплекта автоматически заполняется номер второго комплекта.

Рядом с полям <<Комплекты>> находится флажек <<Неизменно>>. Он отключает редактирование поля с номером второго комплекта. Номера комплектов комплектов обычно идет по порядку, потому ручное изменение номера второго комплекта требуется крайне редко.

В блоке <<Датчики>> указываются серийные номера датчиков для каждого комплекта АСИУТ.

Вблоке предусмотрены 4 поля для серийных номеров датчиков давления и 2 поля для серийных номеров датчиков температуры. Для каждого типа датчиков предусмотренна кнопка \keystroke{Заполнить >}, при нажатии на которую происходит автоматическое значений в соответствии с первым полем для каждого типа датчиков.

Под блоками расположены две кнопки:
\begin{itemize}
    \item \keystroke{Создать таблицу} "--- запускает процедуру подготовки таблицы;
    \item \keystroke{Новая} "--- подготавливает данные для новой таблицы.
\end{itemize}
\newpage
\subsection{Процедура подготовки новой таблицы}
\label{sec:example}
\begin{floatingfigure}{95px}
\centering
\includegraphics[width=50px]{icon.png}
\caption{Иконка.}
\label{fig:icon}
\end{floatingfigure}
Для начала надо запутить программу с помощью иконки на Рабочем столе Windows, которую создал инсталлятор.

При первом запуске программы все поля будут заполнены корректными значениями по-умолчанию. (\autoref{fig:firstrun})

\begin{figure}[h]
\centering
\includegraphics[width=0.8\textwidth]{firstrun.png}
\caption{Первый запуск.}
\label{fig:firstrun}
\end{figure}

Для начала необходимо заполнить блок <<Общие сведения>>:

\begin{enumerate}
    \item Указать марку тепловоза;
    \item Указать серийный номер тепловоза (для быстрого увеличения и уменьшения номера можно использовать клавишы \UArrow и \DArrow соотвественно);
    \item Указать серийный номер первого комплекта, при этом номер второго комплекта и номера соответствующих их датчиков изменются автоматически;
\end{enumerate}

Далее необходимо заполнить блок <<Датчики>>:

\begin{enumerate}
    \item Указать сериные номера датчиков уровня. Если сериный номера идут по порядку, то достаточно указать сериный номер первого датчика,а для заполнения остальных использовать кнопку \keystroke{Заполнить >} рядом с полем серийного мера первого датчика;
    \item Указать сериные номера датчиков температуры. Для этих датчиков тоже предусмотрена кнопка автоматичкого заполнения.
\end{enumerate}

После заполнения всех полей для запуска процедуры генерации таблицы надо нажать кнопку \keystroke{Создать таблицу}. При этом будут проверены все введенные данные. Вслучае обнаружения ошибки программа выведет сообщение с описанием ошибки и кратким пояснением по её устранению. После окончания процедур проверки данных и генерации готовой таблицы будет выведено даилоговое окно сохранения файла с введенным именем файла (\autoref{fig:savedialog}). От пользователя требуется только выбрать папку, в которую программа запишет готовый файл.

\begin{figure}[h]
\centering
\includegraphics[width=0.8\textwidth]{savedialog.png}
\caption{Диалоговое окно сохранения файла}
\label{fig:savedialog}
\end{figure}

Если требуется подготовить новую таблицу для следующих по порядку комплектов, в которых номера датчиков продолжаются также по порядку, то достаточно нажать кнопку \keystroke{Новая}. При этом автоматички увеличится серийный номер тепловоза, номера блоков и серийные номера датчиков,полозователю останется только нажать кнопку \keystroke{Создать таблицу} и сохранить.
\newpage
\section{Информация об авторе и поддержке}
\label{sec:author}
Автор программы: Фролов Павел (\url{http://radjik.blogspot.com})

По вопросам поддержки, обновления и получения исходных текстов обращаться лично или по адресу \url{mailto:pavel@frolov.msk.su}.

Программа написана и отлажена в интегрированной среде разработки Borland\textregistered{} Delphi\textregistered{} 7 без использования сторонних библиотек. Программа не содержит ГМО. При её разработке не пострадало ни одно животное.

Автор не исключает появление жертв при внедрении программы в производство.
\end{document}
