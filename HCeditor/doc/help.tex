\documentclass[final]{article}
\usepackage[cp1251]{inputenc}
\usepackage[russian]{babel}
\usepackage{graphicx}
\usepackage[colorlinks=true,backref,hidelinks,final]{hyperref}
\usepackage{indentfirst}
\usepackage{enumerate}
\usepackage{keystroke}
\usepackage[lflt]{floatflt}
\usepackage{tabularx}
\usepackage{xkeyval}
\hypersetup{pdfauthor=Фролов Павел,
pdftitle=Программный компекс для проведения тепло-энергетических испытаний тепловозов,
pdfdisplaydoctitle=True}

\begin{document}
\title{<<Программный компекс для проведения тепло-энергетических испытаний тепловозов>>\\Руководство поиспользованию}
\author{Фролов Павел}
\date{\today}
\maketitle
\newpage
\tableofcontents
\newpage
\section{Общие сведения}
\label{sec:general}
\subsection{Цели и задачи}
\label{sec:targ}
Данная комплекс программ служит для упрощения разработки циклов и проведения тепло-энергетических испытания тепловозов.

Основной целью при создании комплекса была переработка существующей программы для проведения испытаний. Существующая программа обладала сильно завышенными системными требованиями для своего класса и не отличалась стабильностью работы.
\subsection{Используемые технологии и системные требования}
\label{sec:descr}
Программs комплекса полностью написана на языке Delphi с использованием бесплатного набора компанентов для работы с базами данных ZEOS DBO.

Комплекс совместим со всеми версиями Microsoft\textregistered{} Windows\textregistered{},начиная Windows\textregistered{}2000. Для работы предпочтительно использовать Windows\textregistered{} XP с установленным SP2 или более новую операционную систему.
\newpage
\section{Установка программы}
\subsection{Описание установщика}
Для удобства пользователя комплекс поставляется в виде установочного пакета\footnote{Для создания пакета использовалась система InstallAware\textregistered{} 9. Для её работы требуется Microsoft\textregistered{} Installer\textregistered{}, который обычно уже присуствует в системе Windows\textregistered{} 2000 и выше.}. Программа установки копирует файлы программы в указанный каталог, создает ярлыки для удобного запуска программы и регистрирует в системе программу для корретного удаления.

Для установки комплекса требуется около 5 Мб свободного места на диске. Программа не вносит никаких изменений в реестр системы и может распространяться простым копированием с сохранением минимального набора файлов (\autoref{sec:minfile}), необходимых для работы программы.
\subsection{Состав комплекса}
\label{sec:progfiles}
В состав программы входят следующие файлы:
\begin{enumerate}[\quad]
\item \textbf{HC.exe} "--- программа для проведения испытаний;
\item \textbf{hceditor.exe} "--- редактор испытательных циклов;
\item \textbf{stages.sqlite} "--- база данных, в которой содержатся готовые циклы и этапы для построения новых циклов;
\item \textbf{CreateDB.exe} "--- программа для создания новой базы данных и обслуживания существующей.
\end{enumerate}
\subsection{Минимальный набор файлов}
\label{sec:minfile}
Для проведения испытаний требуется следующий набор набор файлов:
\begin{enumerate}
\item HC.exe
\item один или более hcf-файлов с описанием циклов испытаний.
\end{enumerate}
Для редактирования циклов также потребуются следующие файлы:
\begin{enumerate}
\item hceditor.exe
\item stages.sqlite
\item CreateDB.exe
\end{enumerate}

Структура базы данных будет описана в слудующем разделе.
\newpage
\section{Структура базы данных}
База данных содержит 4 таблицы:
\begin{enumerate}
\item cycle
\item cstruct
\item stages
\item sstruct
\end{enumerate}
\subsection{Описание и назначение таблиц}
\subsubsection{Таблица <<cycle>>}
В этой таблице содержится список готовых циклов с наименованиями и идентификаторами для связи с другими таблицами.
Поля таблицы:
\begin{enumerate}
\item \textbf{cid} "--- идентфикатор цикла (целое);
\item \textbf{cname} "--- наименование цикла (строка).
\end{enumerate}
\subsubsection{Таблица <<cstruct>>}
В этой таблице хранится структура всех созданных циклов. Каждая запись связана с одним из определенных циклов и одним из определенных этапов.
Поля таблицы:
\begin{enumerate}
\item \textbf{id} "--- идентфикатор записи для обеспечения уникальности каждой записи(целое);
\item \textbf{cid} "--- идентификатор цикла для связи записи с созданным циклом (целое);
\item \textbf{corder} "--- порядковый номер этапа в цикле (целое);
\item \textbf{sid} "--- идентификатор этапа для связи записи с определенным этапом (целое).
\end{enumerate}


\newpage
\section{Работа с программой}
\label{sec:interf}
\subsection{Интерфейс программы}
\subsubsection{Окно программы}
\begin{figure}[h]
\centering
\includegraphics[width=0.8\textwidth]{interface.png}
\caption{Окно программы.}
\label{fig:wind}
\end{figure}
На рисунке \ref{fig:wind} представлен общий вид окна программы с примером заполнения полей. Для правильной работы программы должны быть правильно заполнены все поля.
\newpage
\subsubsection{Описание элементов интерфейса программы}
Окно программы разделено на два блока:
\begin{itemize}
    \item Общие сведения
    \item Датчики
\end{itemize}

В блоке <<Общие сведения>> указываются основные сведения для конкретного комплекта АСИУТ.

В поле <<Тарировка для:>> занисится серийный марка тепловоза.

В поле <<№>> заносится серийный номер тепловоза, для которого предназначен комплект АСИУТ.

В поля <<Комплекты>> заносятся серийные номера комплектов АСИУТ. Для одного тепловоза требуется два комплекта измерителей. Для удобства пользователя при вводе номера первого комплекта автоматически заполняется номер второго комплекта.

Рядом с полям <<Комплекты>> находится флажек <<Неизменно>>. Он отключает редактирование поля с номером второго комплекта. Номера комплектов комплектов обычно идет по порядку, потому ручное изменение номера второго комплекта требуется крайне редко.

В блоке <<Датчики>> указываются серийные номера датчиков для каждого комплекта АСИУТ.

Вблоке предусмотрены 4 поля для серийных номеров датчиков давления и 2 поля для серийных номеров датчиков температуры. Для каждого типа датчиков предусмотренна кнопка \keystroke{Заполнить >}, при нажатии на которую происходит автоматическое значений в соответствии с первым полем для каждого типа датчиков.

Под блоками расположены две кнопки:
\begin{itemize}
    \item \keystroke{Создать таблицу} "--- запускает процедуру подготовки таблицы;
    \item \keystroke{Новая} "--- подготавливает данные для новой таблицы.
\end{itemize}
\newpage
\subsection{Процедура подготовки новой таблицы}
\label{sec:example}
\begin{floatingfigure}{95px}
\centering
\includegraphics[width=50px]{icon.png}
\caption{Иконка.}
\label{fig:icon}
\end{floatingfigure}
Для начала надо запутить программу с помощью иконки на Рабочем столе Windows, которую создал инсталлятор.

При первом запуске программы все поля будут заполнены корректными значениями по-умолчанию. (\autoref{fig:firstrun})

\begin{figure}[h]
\centering
\includegraphics[width=0.8\textwidth]{firstrun.png}
\caption{Первый запуск.}
\label{fig:firstrun}
\end{figure}

Для начала необходимо заполнить блок <<Общие сведения>>:

\begin{enumerate}
    \item Указать марку тепловоза;
    \item Указать серийный номер тепловоза (для быстрого увеличения и уменьшения номера можно использовать клавишы \UArrow и \DArrow соотвественно);
    \item Указать серийный номер первого комплекта, при этом номер второго комплекта и номера соответствующих их датчиков изменются автоматически;
\end{enumerate}

Далее необходимо заполнить блок <<Датчики>>:

\begin{enumerate}
    \item Указать сериные номера датчиков уровня. Если сериный номера идут по порядку, то достаточно указать сериный номер первого датчика,а для заполнения остальных использовать кнопку \keystroke{Заполнить >} рядом с полем серийного мера первого датчика;
    \item Указать сериные номера датчиков температуры. Для этих датчиков тоже предусмотрена кнопка автоматичкого заполнения.
\end{enumerate}

После заполнения всех полей для запуска процедуры генерации таблицы надо нажать кнопку \keystroke{Создать таблицу}. При этом будут проверены все введенные данные. Вслучае обнаружения ошибки программа выведет сообщение с описанием ошибки и кратким пояснением по её устранению. После окончания процедур проверки данных и генерации готовой таблицы будет выведено даилоговое окно сохранения файла с введенным именем файла (\autoref{fig:savedialog}). От пользователя требуется только выбрать папку, в которую программа запишет готовый файл.

\begin{figure}[h]
\centering
\includegraphics[width=0.8\textwidth]{savedialog.png}
\caption{Диалоговое окно сохранения файла}
\label{fig:savedialog}
\end{figure}

Если требуется подготовить новую таблицу для следующих по порядку комплектов, в которых номера датчиков продолжаются также по порядку, то достаточно нажать кнопку \keystroke{Новая}. При этом автоматички увеличится серийный номер тепловоза, номера блоков и серийные номера датчиков,полозователю останется только нажать кнопку \keystroke{Создать таблицу} и сохранить.
\newpage
\section{Информация об авторе и поддержке}
\label{sec:author}
Автор программы: Фролов Павел (\url{http://radjik.blogspot.com})

По вопросам поддержки, обновления и получения исходных текстов обращаться лично или по адресу \url{mailto:pavel@frolov.msk.su}.

Программа написана и отлажена в интегрированной среде разработки Borland\textregistered{} Delphi\textregistered{} 7 без использования сторонних библиотек. Программа не содержит ГМО. При её разработке не пострадало ни одно животное.

Автор не исключает появление жертв при внедрении программы в производство.
\end{document}
