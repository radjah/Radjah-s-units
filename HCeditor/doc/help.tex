\documentclass[final]{article}
\usepackage[cp1251]{inputenc}
\usepackage[russian]{babel}
\usepackage{graphicx}
\usepackage[colorlinks=true,backref,hidelinks,final]{hyperref}
\usepackage{indentfirst}
\usepackage{enumerate}
\usepackage{keystroke}
\usepackage[lflt]{floatflt}
\usepackage{tabularx}
\usepackage{xkeyval}
\hypersetup{pdfauthor=Фролов Павел,
pdftitle=Программный компекс для проведения тягово-энергетических испытаний тепловозов,
pdfdisplaydoctitle=True}

\begin{document}
\title{<<Программный компекс для проведения тягово-энергетических испытаний тепловозов>>\\Руководство по использованию}
\author{Фролов Павел}
\date{\today}
\maketitle
\newpage
\tableofcontents
\newpage
\section{Общие сведения}
\label{sec:general}
\subsection{Цели и задачи}
\label{sec:targ}
Данная комплекс программ служит для упрощения разработки циклов и проведения тягово-энергетических испытания тепловозов.

Основной целью при создании комплекса была переработка существующей программы для проведения испытаний. Существующая программа обладала сильно завышенными системными требованиями для своего класса и не отличалась стабильностью работы.
\subsection{Используемые технологии и системные требования}
\label{sec:descr}
Программs комплекса полностью написана на языке Delphi с использованием бесплатного набора компанентов для работы с базами данных ZEOS DBO.

Комплекс совместим со всеми версиями Microsoft\textregistered{} Windows\textregistered{},начиная Windows\textregistered{}2000. Для работы предпочтительно использовать Windows\textregistered{} XP с установленным SP2 или более новую операционную систему.
\newpage
\section{Установка программы}
\subsection{Описание установщика}
Для удобства пользователя комплекс поставляется в виде установочного пакета\footnote{Для создания пакета использовалась система InstallAware\textregistered{} 9. Для её работы требуется Microsoft\textregistered{} Installer\textregistered{}, который обычно уже присуствует в системе Windows\textregistered{} 2000 и выше.}. Программа установки копирует файлы программы в указанный каталог, создает ярлыки для удобного запуска программы и регистрирует в системе программу для корретного удаления.

Для установки комплекса требуется около 5 Мб свободного места на диске. Программа не вносит никаких изменений в реестр системы и может распространяться простым копированием с сохранением минимального набора файлов (\autoref{sec:minfile}), необходимых для работы программы.
\subsection{Состав комплекса}
\label{sec:progfiles}
В состав программы входят следующие файлы:
\begin{enumerate}[\quad]
\item \textbf{HC.exe} "--- программа для проведения испытаний;
\item \textbf{hceditor.exe} "--- редактор испытательных циклов;
\item \textbf{stages.sqlite} "--- база данных, в которой содержатся готовые циклы и этапы для построения новых циклов;
\item \textbf{CreateDB.exe} "--- программа для создания новой базы данных и обслуживания существующей.
\item \textbf{sqlite3.dll} "--- библиотека дополнительных функций для программы обслуживания базы данных.
\end{enumerate}
\subsection{Минимальный набор файлов}
\label{sec:minfile}
Для проведения испытаний требуется следующий набор набор файлов:
\begin{enumerate}
\item HC.exe
\item один или более hcf-файлов с описанием циклов испытаний.
\end{enumerate}
Для редактирования циклов также потребуются следующие файлы:
\begin{enumerate}
\item hceditor.exe
\item stages.sqlite
\item CreateDB.exe
\item sqlite3.dll
\end{enumerate}

Структура базы данных будет описана в слудующем разделе.
\newpage
\section{Структура базы данных}
База данных содержит 4 таблицы:
\begin{enumerate}
\item cycle
\item cstruct
\item stages
\item sstruct
\end{enumerate}
\subsection{Описание и назначение таблиц}
\subsubsection{Таблица <<cycle>>}
В этой таблице содержится список готовых циклов с наименованиями и идентификаторами для связи с другими таблицами.
Поля таблицы:
\begin{enumerate}
\item \textbf{cid} "--- идентфикатор цикла (целое);
\item \textbf{cname} "--- наименование цикла (строка).
\end{enumerate}
\subsubsection{Таблица <<cstruct>>}
В этой таблице хранится структура всех созданных циклов. Каждая запись связана с одним из определенных циклов и одним из определенных этапов.
Поля таблицы:
\begin{enumerate}
\item \textbf{id} "--- идентфикатор для обеспечения уникальности каждой записи (целое);
\item \textbf{cid} "--- идентификатор цикла для связи записи с созданным циклом (целое);
\item \textbf{corder} "--- порядковый номер этапа в цикле (целое);
\item \textbf{sid} "--- идентификатор этапа для связи записи с определенным этапом (целое).
\end{enumerate}
\subsubsection{Таблица <<stages>>}
В этой таблице содержится список готовых этапов с наименованиями и идентификаторами для связи с другими таблицами.
Поля таблицы:
\begin{enumerate}
\item \textbf{sid} "--- идентфикатор этапа для связи со страктурой этапа и структурами циклов (целое);
\item \textbf{sname} "--- наименование этапа (строка);
\end{enumerate}

\subsubsection{Таблица <<cstruct>>}
В этой таблице хранится структура всех созданных циклов. Каждая запись связана с одним из определенных циклов и одним из определенных этапов.
Поля таблицы:
\begin{enumerate}
\item \textbf{pid} "--- идентфикатор для обеспечения уникальности каждой записи (целое);
\item \textbf{sid} "--- идентификатор этапа для связи записи с созданным этапом (целое);
\item \textbf{clevel} "--- значение позиции контроллера (целое);
\item \textbf{ptime} "--- время работы на указанной позиции (целое);
\item \textbf{porder} "--- порядковый номер указанной позиции в этапе (целое).
\end{enumerate}

\newpage
\section{Работа с программами комплекса}
\label{sec:progs}
\subsection{Программа испытаний}
\label{sec:testprog}
\subsubsection{Окно программы}
\label{sec:testprogwnd}
\begin{figure}[h]
\centering
\includegraphics[width=0.95\textwidth]{testproginterface.png}
\caption{Окно программы.}
\label{fig:testprogwind}
\end{figure}
На рисунке \ref{fig:testprogwind} представлен общий вид окна программы непосредственно после запуска. Файл цикла еще не загружен, поэтому информация о времени позициях не выводится.
\newpage
\subsubsection{Описание элементов интерфейса программы}
Для управления программой используются три кнопки в нижней части окна.

Кнопка \keystroke{Загрузить} используется указания файла с описанием цикла и загрузки информации из него.

Кнопка \keystroke{Поехали!} используется для запуска загруженного цикла.

Кнопка \keystroke{О программе} выводит окно с информацией о версии и авторе программы.

Во время работы программы выводится следующая информация (слева направо и сверху вниз):
\begin{itemize}
    \item Текущая позиция контроллера;
    \item Текущий этап цикла и общее количество этапов;
    \item Следующая позиция контроллера;
    \item Оставшееся время работы на указанной позиции;
    \item Прогресс-бар с наглядным представлением пройденного и оставшегося времени;
    \item Представление цикла в виде зависимости позиции контроллера от времени.
\end{itemize}
\newpage
\subsubsection{Работа с программой}
\label{sec:testprogwork}
Работа с программой состоит из трех этапов:
\begin{enumerate}
    \item Запуск программы;
    \item Загрузка цикла из файла;
    \item Запуск цикла.
\end{enumerate}
Запуск программы осущствеляется с помощью ярлыка в главном меню, яралыка на рабочем столе или запуском непосредственно exe-файла "HC.exe". После запуска на экране отобразится окно как на рисунке . Кнопка \keystroke{Поехали!} неактивна, потому что цикл испытаний не загружен.

\begin{figure}[h]
\centering
\includegraphics[width=0.95\textwidth]{testprogworkload.png}
\caption{Окно открытия файла с циклом испытаний.}
\label{fig:testprogload}
\end{figure}

Для загрузки цикла из файла надо нажать кнопку \keystroke{Загрузить} и выбрать hcf-файл, содержащий информацию о цикле. (Рис. \ref{fig:testprogload})

После загрузки файла появится сообщение с информацией о загруженном цикле (Рис. \ref{fig:testproginfo}), а само окно программы отобразит начальные условия цикла и его графическое представление (Рис. \ref{fig:testprogready}).

После загрузки цикла можно приступать к испытаниям. Для этого надо нажать кнопку \keystroke{Поехали!}. При этом запустится отсчет времени,отобразится информация о следующей позиции, и график по мере прохождения цикла испытания будет закрашиываться красным цветом. Моменты переключения позиций контроллера программа будет обозначать звуковым сигналом. Выполнение цикла можно остановить закрытием программы.

\begin{figure}
\centering
\includegraphics[width=0.4\textwidth]{testproginfo.png}
\caption{Информация о загруженном цикле.}
\label{fig:testproginfo}
\end{figure}
\begin{figure}[h]
\centering
\includegraphics[width=0.85\textwidth]{testprogwork.png}
\caption{Окно программы после загрузки файла цикла.}
\label{fig:testprogready}
\end{figure}
\begin{figure}
\centering
\includegraphics[width=0.85\textwidth]{testprogworkprogress.png}
\caption{Окно программы во время проведения испытаний.}
\label{fig:testprogworkprogress}
\end{figure}
\newpage
\subsection{Редактор циклов}
\label{sec:editorprog}
\subsubsection{Окно программы}
\label{sec:editprogwind}
\begin{figure}[h]
\centering
\includegraphics[width=0.85\textwidth]{editproginterface.png}
\caption{Окно программы.}
\label{fig:editproginterface}
\end{figure}

На рисунке \ref{fig:editproginterface} представлен общий вид окна редактора циклов с уже созданными циклами.

Окно программы разделено на две функциональные части: список циклов и управляющие кнопки.

Кнопка \keystroke{Создать цикл} запускает процедуру создания нового цикла.

Кнопка \keystroke{Изменить цикл} запускает процедуру редактирования выбранного цикла. Если не задано ни одного цикла, то эта кнопка будет неактивна.

Кнопка \keystroke{Переименовать} запускает процедуру переименования выбранного цикла. Если не задано ни одного цикла, то эта кнопка будет неактивна.

Кнопка \keystroke{Удалить цикл} запускает процедуру удаления выбранного цикла. Если не задано ни одного цикла, то эта кнопка будет неактивна.

Кнопка \keystroke{Просмотр и экспорт} запускает позволяет посмотреть графическое предстваление выбранного цикла и осуществить его экспорт в hcf-файл. Если не задано ни одного цикла, то эта кнопка будет неактивна.

Кнопка \keystroke{Редактор этапов} запускает запускает радактор этапов,из которых можно составить новые циклы.

\newpage
\subsubsection{Работа с программой}
\label{sec:editprogwork}

\newpage
\section{Информация об авторе и поддержке}
\label{sec:author}
Автор программы: Фролов Павел (\url{http://radjik.blogspot.com})

По вопросам поддержки, обновления и получения исходных текстов обращаться лично или по адресу \url{mailto:radjah@ya.su}.

Программа не содержит ГМО. При её разработке не пострадало ни одно животное.

Автор не исключает появление жертв при внедрении программы в производство.
\end{document}
